{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Data as Code Metadata",
  "description": "A metadata object that defines a data object associated with a Data As Code recipe",
  "type": "object",
  "definitions": {
    "fingerprint": {
      "description": "derived deterministic identifier of the codified metadata",
      "type": "string",
      "pattern": "^[a-f0-9]{8}$",
      "examples": [
        "a6e33a13",
        "8719003a"
      ]
    }
  },
  "properties": {
    "fingerprint": {
      "$ref": "#/definitions/fingerprint"
    },
    "codified": {
      "description": "metadata defined as code within recipe",
      "type": "object",
      "properties": {
        "fingerprint": {
          "$ref": "#/definitions/fingerprint"
        },
        "description": {
          "description": "docstring description of step that produced data",
          "type": "string"
        },
        "path": {
          "description": "a relative path to a file which contains the referenced data",
          "type": "string",
          "examples": [
            "data/my_file.csv",
            "data/that_file.parquet"
          ]
        },
        "lineage": {
          "description": "list of fingerprints for codified nodes of lineage",
          "type": "array",
          "items": {
            "$ref": "#/definitions/fingerprint"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "required": [
        "fingerprint"
      ],
      "additionalProperties": false
    },
    "derived": {
      "description": "metadata derived from artifacts during recipe execution",
      "type": "object",
      "properties": {
        "fingerprint": {
          "$ref": "#/definitions/fingerprint"
        },
        "checksum": {
          "description": "md5 checksum of the file",
          "type": "string",
          "pattern": "^[a-f0-9]{32}$"
        },
        "lineage": {
          "description": "list of fingerprints for derived nodes of lineage",
          "type": "array",
          "items": {
            "$ref": "#/definitions/fingerprint"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "required": [
        "fingerprint"
      ],
      "additionalProperties": false
    },
    "incidental": {
      "$ref": "#/definitions/incidental"
    },
    "lineage": {
      "description": "lineage description",
      "type": "array",
      "items": {
        "$ref": "#"
      },
      "minItems": 1,
      "uniqueItems": true
    }
  },
  "required": [
    "fingerprint",
    "codified",
    "derived"
  ],
  "additionalProperties": false
}
